{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"file":"turbopack:///[project]/node_modules/.pnpm/better-auth@1.4.9_drizzle-kit@0.31.8_drizzle-orm@0.45.1_@opentelemetry+api@1.9.0_@types_2c2f84378f2ef24b1a7bf909953e43a4/node_modules/better-auth/dist/plugins/admin/access/statement.mjs","sources":["file:///Users/aunogarafat/Work/conversation/app/web/node_modules/.pnpm/better-auth%401.4.9_drizzle-kit%400.31.8_drizzle-orm%400.45.1_%40opentelemetry%2Bapi%401.9.0_%40types_2c2f84378f2ef24b1a7bf909953e43a4/node_modules/better-auth/src/plugins/admin/access/statement.ts"],"sourcesContent":["import { createAccessControl } from \"../../access\";\n\nexport const defaultStatements = {\n\tuser: [\n\t\t\"create\",\n\t\t\"list\",\n\t\t\"set-role\",\n\t\t\"ban\",\n\t\t\"impersonate\",\n\t\t\"delete\",\n\t\t\"set-password\",\n\t\t\"get\",\n\t\t\"update\",\n\t],\n\tsession: [\"list\", \"revoke\", \"delete\"],\n} as const;\n\nexport const defaultAc = createAccessControl(defaultStatements);\n\nexport const adminAc = defaultAc.newRole({\n\tuser: [\n\t\t\"create\",\n\t\t\"list\",\n\t\t\"set-role\",\n\t\t\"ban\",\n\t\t\"impersonate\",\n\t\t\"delete\",\n\t\t\"set-password\",\n\t\t\"get\",\n\t\t\"update\",\n\t],\n\tsession: [\"list\", \"revoke\", \"delete\"],\n});\n\nexport const userAc = defaultAc.newRole({\n\tuser: [],\n\tsession: [],\n});\n\nexport const defaultRoles = {\n\tadmin: adminAc,\n\tuser: userAc,\n};\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;AAEA,MAAa,oBAAoB;IAChC,MAAM;QACL;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;KACA;IACD,SAAS;QAAC;QAAQ;QAAU;KAAS;CACrC;AAED,MAAa,gBAAY,2YAAA,EAAoB,kBAAkB;AAE/D,MAAa,UAAU,UAAU,OAAA,CAAQ;IACxC,MAAM;QACL;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;KACA;IACD,SAAS;QAAC;QAAQ;QAAU;KAAS;CACrC,CAAC;AAEF,MAAa,SAAS,UAAU,OAAA,CAAQ;IACvC,MAAM,EAAE;IACR,SAAS,EAAE;CACX,CAAC;AAEF,MAAa,eAAe;IAC3B,OAAO;IACP,MAAM;CACN"}},
    {"offset": {"line": 72, "column": 0}, "map": {"version":3,"sources":["file:///Users/aunogarafat/Work/conversation/app/web/node_modules/.pnpm/better-auth%401.4.9_drizzle-kit%400.31.8_drizzle-orm%400.45.1_%40opentelemetry%2Bapi%401.9.0_%40types_2c2f84378f2ef24b1a7bf909953e43a4/node_modules/better-auth/dist/plugins/admin/access/index.mjs"],"sourcesContent":["import { adminAc, defaultAc, defaultRoles, defaultStatements, userAc } from \"./statement.mjs\";\n\nexport { adminAc, defaultAc, defaultRoles, defaultStatements, userAc };"],"names":[],"mappings":";AAAA","ignoreList":[0]}},
    {"offset": {"line": 80, "column": 0}, "map": {"version":3,"file":"turbopack:///[project]/node_modules/.pnpm/better-auth@1.4.9_drizzle-kit@0.31.8_drizzle-orm@0.45.1_@opentelemetry+api@1.9.0_@types_2c2f84378f2ef24b1a7bf909953e43a4/node_modules/better-auth/dist/plugins/admin/error-codes.mjs","sources":["file:///Users/aunogarafat/Work/conversation/app/web/node_modules/.pnpm/better-auth%401.4.9_drizzle-kit%400.31.8_drizzle-orm%400.45.1_%40opentelemetry%2Bapi%401.9.0_%40types_2c2f84378f2ef24b1a7bf909953e43a4/node_modules/better-auth/src/plugins/admin/error-codes.ts"],"sourcesContent":["// NOTE: Error code const must be all capital of string (ref https://github.com/better-auth/better-auth/issues/4386)\nimport { defineErrorCodes } from \"@better-auth/core/utils\";\n\nexport const ADMIN_ERROR_CODES = defineErrorCodes({\n\tFAILED_TO_CREATE_USER: \"Failed to create user\",\n\tUSER_ALREADY_EXISTS: \"User already exists.\",\n\tUSER_ALREADY_EXISTS_USE_ANOTHER_EMAIL:\n\t\t\"User already exists. Use another email.\",\n\tYOU_CANNOT_BAN_YOURSELF: \"You cannot ban yourself\",\n\tYOU_ARE_NOT_ALLOWED_TO_CHANGE_USERS_ROLE:\n\t\t\"You are not allowed to change users role\",\n\tYOU_ARE_NOT_ALLOWED_TO_CREATE_USERS: \"You are not allowed to create users\",\n\tYOU_ARE_NOT_ALLOWED_TO_LIST_USERS: \"You are not allowed to list users\",\n\tYOU_ARE_NOT_ALLOWED_TO_LIST_USERS_SESSIONS:\n\t\t\"You are not allowed to list users sessions\",\n\tYOU_ARE_NOT_ALLOWED_TO_BAN_USERS: \"You are not allowed to ban users\",\n\tYOU_ARE_NOT_ALLOWED_TO_IMPERSONATE_USERS:\n\t\t\"You are not allowed to impersonate users\",\n\tYOU_ARE_NOT_ALLOWED_TO_REVOKE_USERS_SESSIONS:\n\t\t\"You are not allowed to revoke users sessions\",\n\tYOU_ARE_NOT_ALLOWED_TO_DELETE_USERS: \"You are not allowed to delete users\",\n\tYOU_ARE_NOT_ALLOWED_TO_SET_USERS_PASSWORD:\n\t\t\"You are not allowed to set users password\",\n\tBANNED_USER: \"You have been banned from this application\",\n\tYOU_ARE_NOT_ALLOWED_TO_GET_USER: \"You are not allowed to get user\",\n\tNO_DATA_TO_UPDATE: \"No data to update\",\n\tYOU_ARE_NOT_ALLOWED_TO_UPDATE_USERS: \"You are not allowed to update users\",\n\tYOU_CANNOT_REMOVE_YOURSELF: \"You cannot remove yourself\",\n\tYOU_ARE_NOT_ALLOWED_TO_SET_NON_EXISTENT_VALUE:\n\t\t\"You are not allowed to set a non-existent role value\",\n\tYOU_CANNOT_IMPERSONATE_ADMINS: \"You cannot impersonate admins\",\n\tINVALID_ROLE_TYPE: \"Invalid role type\",\n});\n"],"names":[],"mappings":";;;;;;;;AAGA,MAAa,wBAAoB,kbAAA,EAAiB;IACjD,uBAAuB;IACvB,qBAAqB;IACrB,uCACC;IACD,yBAAyB;IACzB,0CACC;IACD,qCAAqC;IACrC,mCAAmC;IACnC,4CACC;IACD,kCAAkC;IAClC,0CACC;IACD,8CACC;IACD,qCAAqC;IACrC,2CACC;IACD,aAAa;IACb,iCAAiC;IACjC,mBAAmB;IACnB,qCAAqC;IACrC,4BAA4B;IAC5B,+CACC;IACD,+BAA+B;IAC/B,mBAAmB;CACnB,CAAC"}},
    {"offset": {"line": 117, "column": 0}, "map": {"version":3,"file":"turbopack:///[project]/node_modules/.pnpm/better-auth@1.4.9_drizzle-kit@0.31.8_drizzle-orm@0.45.1_@opentelemetry+api@1.9.0_@types_2c2f84378f2ef24b1a7bf909953e43a4/node_modules/better-auth/dist/plugins/admin/has-permission.mjs","sources":["file:///Users/aunogarafat/Work/conversation/app/web/node_modules/.pnpm/better-auth%401.4.9_drizzle-kit%400.31.8_drizzle-orm%400.45.1_%40opentelemetry%2Bapi%401.9.0_%40types_2c2f84378f2ef24b1a7bf909953e43a4/node_modules/better-auth/src/plugins/admin/has-permission.ts"],"sourcesContent":["import { defaultRoles } from \"./access\";\nimport type { AdminOptions } from \"./types\";\n\ntype PermissionExclusive =\n\t| {\n\t\t\t/**\n\t\t\t * @deprecated Use `permissions` instead\n\t\t\t */\n\t\t\tpermission: { [key: string]: string[] };\n\t\t\tpermissions?: never | undefined;\n\t  }\n\t| {\n\t\t\tpermissions: { [key: string]: string[] };\n\t\t\tpermission?: never | undefined;\n\t  };\n\nexport const hasPermission = (\n\tinput: {\n\t\tuserId?: string | undefined;\n\t\trole?: string | undefined;\n\t\toptions?: AdminOptions | undefined;\n\t} & PermissionExclusive,\n) => {\n\tif (input.userId && input.options?.adminUserIds?.includes(input.userId)) {\n\t\treturn true;\n\t}\n\tif (!input.permissions && !input.permission) {\n\t\treturn false;\n\t}\n\tconst roles = (input.role || input.options?.defaultRole || \"user\").split(\",\");\n\tconst acRoles = input.options?.roles || defaultRoles;\n\tfor (const role of roles) {\n\t\tconst _role = acRoles[role as keyof typeof acRoles];\n\t\tconst result = _role?.authorize(input.permission ?? input.permissions);\n\t\tif (result?.success) {\n\t\t\treturn true;\n\t\t}\n\t}\n\treturn false;\n};\n"],"names":[],"mappings":";;;;;;;;;AAgBA,MAAa,gBAAA,CACZ,UAKI;IACJ,IAAI,MAAM,MAAA,IAAU,MAAM,OAAA,EAAS,cAAc,SAAS,MAAM,MAAA,CAAO,CACtE,CAAA,OAAO;IAER,IAAI,CAAC,MAAM,WAAA,IAAe,CAAC,MAAM,UAAA,CAChC,CAAA,OAAO;IAER,MAAM,QAAA,CAAS,MAAM,IAAA,IAAQ,MAAM,OAAA,EAAS,eAAe,MAAA,EAAQ,KAAA,CAAM,IAAI;IAC7E,MAAM,UAAU,MAAM,OAAA,EAAS,SAAS,gZAAA;IACxC,KAAK,MAAM,QAAQ,MAGlB,IAFc,OAAA,CAAQ,KAAA,EACA,UAAU,MAAM,UAAA,IAAc,MAAM,WAAA,CAAY,EAC1D,QACX,CAAA,OAAO;IAGT,OAAO"}},
    {"offset": {"line": 140, "column": 0}, "map": {"version":3,"file":"turbopack:///[project]/node_modules/.pnpm/better-auth@1.4.9_drizzle-kit@0.31.8_drizzle-orm@0.45.1_@opentelemetry+api@1.9.0_@types_2c2f84378f2ef24b1a7bf909953e43a4/node_modules/better-auth/dist/plugins/admin/routes.mjs","sources":["file:///Users/aunogarafat/Work/conversation/app/web/node_modules/.pnpm/better-auth%401.4.9_drizzle-kit%400.31.8_drizzle-orm%400.45.1_%40opentelemetry%2Bapi%401.9.0_%40types_2c2f84378f2ef24b1a7bf909953e43a4/node_modules/better-auth/src/plugins/admin/routes.ts"],"sourcesContent":["import {\n\tcreateAuthEndpoint,\n\tcreateAuthMiddleware,\n} from \"@better-auth/core/api\";\nimport type { Session } from \"@better-auth/core/db\";\nimport type { Where } from \"@better-auth/core/db/adapter\";\nimport { BASE_ERROR_CODES } from \"@better-auth/core/error\";\nimport * as z from \"zod\";\nimport { APIError, getSessionFromCtx } from \"../../api\";\nimport { deleteSessionCookie, setSessionCookie } from \"../../cookies\";\nimport { parseUserOutput } from \"../../db/schema\";\nimport { getDate } from \"../../utils/date\";\nimport type { AccessControl } from \"../access\";\nimport type { defaultStatements } from \"./access\";\nimport { ADMIN_ERROR_CODES } from \"./error-codes\";\nimport { hasPermission } from \"./has-permission\";\nimport type {\n\tAdminOptions,\n\tInferAdminRolesFromOption,\n\tSessionWithImpersonatedBy,\n\tUserWithRole,\n} from \"./types\";\n\n/**\n * Ensures a valid session, if not will throw.\n * Will also provide additional types on the user to include role types.\n */\nconst adminMiddleware = createAuthMiddleware(async (ctx) => {\n\tconst session = await getSessionFromCtx(ctx);\n\tif (!session) {\n\t\tthrow new APIError(\"UNAUTHORIZED\");\n\t}\n\treturn {\n\t\tsession,\n\t} as {\n\t\tsession: {\n\t\t\tuser: UserWithRole;\n\t\t\tsession: Session;\n\t\t};\n\t};\n});\n\nfunction parseRoles(roles: string | string[]): string {\n\treturn Array.isArray(roles) ? roles.join(\",\") : roles;\n}\n\nconst setRoleBodySchema = z.object({\n\tuserId: z.coerce.string().meta({\n\t\tdescription: \"The user id\",\n\t}),\n\trole: z\n\t\t.union([\n\t\t\tz.string().meta({\n\t\t\t\tdescription: \"The role to set. `admin` or `user` by default\",\n\t\t\t}),\n\t\t\tz.array(\n\t\t\t\tz.string().meta({\n\t\t\t\t\tdescription: \"The roles to set. `admin` or `user` by default\",\n\t\t\t\t}),\n\t\t\t),\n\t\t])\n\t\t.meta({\n\t\t\tdescription:\n\t\t\t\t\"The role to set, this can be a string or an array of strings. Eg: `admin` or `[admin, user]`\",\n\t\t}),\n});\n\n/**\n * ### Endpoint\n *\n * POST `/admin/set-role`\n *\n * ### API Methods\n *\n * **server:**\n * `auth.api.setRole`\n *\n * **client:**\n * `authClient.admin.setRole`\n *\n * @see [Read our docs to learn more.](https://better-auth.com/docs/plugins/admin#api-method-admin-set-role)\n */\nexport const setRole = <O extends AdminOptions>(opts: O) =>\n\tcreateAuthEndpoint(\n\t\t\"/admin/set-role\",\n\t\t{\n\t\t\tmethod: \"POST\",\n\t\t\tbody: setRoleBodySchema,\n\t\t\trequireHeaders: true,\n\t\t\tuse: [adminMiddleware],\n\t\t\tmetadata: {\n\t\t\t\topenapi: {\n\t\t\t\t\toperationId: \"setUserRole\",\n\t\t\t\t\tsummary: \"Set the role of a user\",\n\t\t\t\t\tdescription: \"Set the role of a user\",\n\t\t\t\t\tresponses: {\n\t\t\t\t\t\t200: {\n\t\t\t\t\t\t\tdescription: \"User role updated\",\n\t\t\t\t\t\t\tcontent: {\n\t\t\t\t\t\t\t\t\"application/json\": {\n\t\t\t\t\t\t\t\t\tschema: {\n\t\t\t\t\t\t\t\t\t\ttype: \"object\",\n\t\t\t\t\t\t\t\t\t\tproperties: {\n\t\t\t\t\t\t\t\t\t\t\tuser: {\n\t\t\t\t\t\t\t\t\t\t\t\t$ref: \"#/components/schemas/User\",\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t$Infer: {\n\t\t\t\t\tbody: {} as {\n\t\t\t\t\t\tuserId: string;\n\t\t\t\t\t\trole: InferAdminRolesFromOption<O> | InferAdminRolesFromOption<O>[];\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\t\t},\n\t\tasync (ctx) => {\n\t\t\tconst canSetRole = hasPermission({\n\t\t\t\tuserId: ctx.context.session.user.id,\n\t\t\t\trole: ctx.context.session.user.role,\n\t\t\t\toptions: opts,\n\t\t\t\tpermissions: {\n\t\t\t\t\tuser: [\"set-role\"],\n\t\t\t\t},\n\t\t\t});\n\t\t\tif (!canSetRole) {\n\t\t\t\tthrow new APIError(\"FORBIDDEN\", {\n\t\t\t\t\tmessage: ADMIN_ERROR_CODES.YOU_ARE_NOT_ALLOWED_TO_CHANGE_USERS_ROLE,\n\t\t\t\t});\n\t\t\t}\n\t\t\tconst roles = opts.roles;\n\t\t\tif (roles) {\n\t\t\t\tconst inputRoles = Array.isArray(ctx.body.role)\n\t\t\t\t\t? ctx.body.role\n\t\t\t\t\t: [ctx.body.role];\n\t\t\t\tfor (const role of inputRoles) {\n\t\t\t\t\tif (!roles[role as keyof typeof roles]) {\n\t\t\t\t\t\tthrow new APIError(\"BAD_REQUEST\", {\n\t\t\t\t\t\t\tmessage:\n\t\t\t\t\t\t\t\tADMIN_ERROR_CODES.YOU_ARE_NOT_ALLOWED_TO_SET_NON_EXISTENT_VALUE,\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tconst updatedUser = await ctx.context.internalAdapter.updateUser(\n\t\t\t\tctx.body.userId,\n\t\t\t\t{\n\t\t\t\t\trole: parseRoles(ctx.body.role),\n\t\t\t\t},\n\t\t\t);\n\t\t\treturn ctx.json({\n\t\t\t\tuser: updatedUser as UserWithRole,\n\t\t\t});\n\t\t},\n\t);\n\nconst getUserQuerySchema = z.object({\n\tid: z.string().meta({\n\t\tdescription: \"The id of the User\",\n\t}),\n});\n\nexport const getUser = (opts: AdminOptions) =>\n\tcreateAuthEndpoint(\n\t\t\"/admin/get-user\",\n\t\t{\n\t\t\tmethod: \"GET\",\n\t\t\tquery: getUserQuerySchema,\n\t\t\tuse: [adminMiddleware],\n\t\t\tmetadata: {\n\t\t\t\topenapi: {\n\t\t\t\t\toperationId: \"getUser\",\n\t\t\t\t\tsummary: \"Get an existing user\",\n\t\t\t\t\tdescription: \"Get an existing user\",\n\t\t\t\t\tresponses: {\n\t\t\t\t\t\t200: {\n\t\t\t\t\t\t\tdescription: \"User\",\n\t\t\t\t\t\t\tcontent: {\n\t\t\t\t\t\t\t\t\"application/json\": {\n\t\t\t\t\t\t\t\t\tschema: {\n\t\t\t\t\t\t\t\t\t\ttype: \"object\",\n\t\t\t\t\t\t\t\t\t\tproperties: {\n\t\t\t\t\t\t\t\t\t\t\tuser: {\n\t\t\t\t\t\t\t\t\t\t\t\t$ref: \"#/components/schemas/User\",\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\t\t},\n\t\tasync (ctx) => {\n\t\t\tconst { id } = ctx.query;\n\n\t\t\tconst canGetUser = hasPermission({\n\t\t\t\tuserId: ctx.context.session.user.id,\n\t\t\t\trole: ctx.context.session.user.role,\n\t\t\t\toptions: opts,\n\t\t\t\tpermissions: {\n\t\t\t\t\tuser: [\"get\"],\n\t\t\t\t},\n\t\t\t});\n\n\t\t\tif (!canGetUser) {\n\t\t\t\tthrow ctx.error(\"FORBIDDEN\", {\n\t\t\t\t\tmessage: ADMIN_ERROR_CODES.YOU_ARE_NOT_ALLOWED_TO_GET_USER,\n\t\t\t\t\tcode: \"YOU_ARE_NOT_ALLOWED_TO_GET_USER\",\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tconst user = await ctx.context.internalAdapter.findUserById(id);\n\n\t\t\tif (!user) {\n\t\t\t\tthrow new APIError(\"NOT_FOUND\", {\n\t\t\t\t\tmessage: BASE_ERROR_CODES.USER_NOT_FOUND,\n\t\t\t\t});\n\t\t\t}\n\n\t\t\treturn parseUserOutput(ctx.context.options, user);\n\t\t},\n\t);\n\nconst createUserBodySchema = z.object({\n\temail: z.string().meta({\n\t\tdescription: \"The email of the user\",\n\t}),\n\tpassword: z.string().meta({\n\t\tdescription: \"The password of the user\",\n\t}),\n\tname: z.string().meta({\n\t\tdescription: \"The name of the user\",\n\t}),\n\trole: z\n\t\t.union([\n\t\t\tz.string().meta({\n\t\t\t\tdescription: \"The role of the user\",\n\t\t\t}),\n\t\t\tz.array(\n\t\t\t\tz.string().meta({\n\t\t\t\t\tdescription: \"The roles of user\",\n\t\t\t\t}),\n\t\t\t),\n\t\t])\n\t\t.optional()\n\t\t.meta({\n\t\t\tdescription: `A string or array of strings representing the roles to apply to the new user. Eg: \\\"user\\\"`,\n\t\t}),\n\t/**\n\t * extra fields for user\n\t */\n\tdata: z.record(z.string(), z.any()).optional().meta({\n\t\tdescription:\n\t\t\t\"Extra fields for the user. Including custom additional fields.\",\n\t}),\n});\n\n/**\n * ### Endpoint\n *\n * POST `/admin/create-user`\n *\n * ### API Methods\n *\n * **server:**\n * `auth.api.createUser`\n *\n * **client:**\n * `authClient.admin.createUser`\n *\n * @see [Read our docs to learn more.](https://better-auth.com/docs/plugins/admin#api-method-admin-create-user)\n */\nexport const createUser = <O extends AdminOptions>(opts: O) =>\n\tcreateAuthEndpoint(\n\t\t\"/admin/create-user\",\n\t\t{\n\t\t\tmethod: \"POST\",\n\t\t\tbody: createUserBodySchema,\n\t\t\tmetadata: {\n\t\t\t\topenapi: {\n\t\t\t\t\toperationId: \"createUser\",\n\t\t\t\t\tsummary: \"Create a new user\",\n\t\t\t\t\tdescription: \"Create a new user\",\n\t\t\t\t\tresponses: {\n\t\t\t\t\t\t200: {\n\t\t\t\t\t\t\tdescription: \"User created\",\n\t\t\t\t\t\t\tcontent: {\n\t\t\t\t\t\t\t\t\"application/json\": {\n\t\t\t\t\t\t\t\t\tschema: {\n\t\t\t\t\t\t\t\t\t\ttype: \"object\",\n\t\t\t\t\t\t\t\t\t\tproperties: {\n\t\t\t\t\t\t\t\t\t\t\tuser: {\n\t\t\t\t\t\t\t\t\t\t\t\t$ref: \"#/components/schemas/User\",\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t$Infer: {\n\t\t\t\t\tbody: {} as {\n\t\t\t\t\t\temail: string;\n\t\t\t\t\t\tpassword: string;\n\t\t\t\t\t\tname: string;\n\t\t\t\t\t\trole?:\n\t\t\t\t\t\t\t| (InferAdminRolesFromOption<O> | InferAdminRolesFromOption<O>[])\n\t\t\t\t\t\t\t| undefined;\n\t\t\t\t\t\tdata?: Record<string, any> | undefined;\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\t\t},\n\t\tasync (ctx) => {\n\t\t\tconst session = await getSessionFromCtx<{ role: string }>(ctx);\n\t\t\tif (!session && (ctx.request || ctx.headers)) {\n\t\t\t\tthrow ctx.error(\"UNAUTHORIZED\");\n\t\t\t}\n\t\t\tif (session) {\n\t\t\t\tconst canCreateUser = hasPermission({\n\t\t\t\t\tuserId: session.user.id,\n\t\t\t\t\trole: session.user.role,\n\t\t\t\t\toptions: opts,\n\t\t\t\t\tpermissions: {\n\t\t\t\t\t\tuser: [\"create\"],\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t\tif (!canCreateUser) {\n\t\t\t\t\tthrow new APIError(\"FORBIDDEN\", {\n\t\t\t\t\t\tmessage: ADMIN_ERROR_CODES.YOU_ARE_NOT_ALLOWED_TO_CREATE_USERS,\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst email = ctx.body.email.toLowerCase();\n\t\t\tconst isValidEmail = z.email().safeParse(email);\n\t\t\tif (!isValidEmail.success) {\n\t\t\t\tthrow new APIError(\"BAD_REQUEST\", {\n\t\t\t\t\tmessage: BASE_ERROR_CODES.INVALID_EMAIL,\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tconst existUser =\n\t\t\t\tawait ctx.context.internalAdapter.findUserByEmail(email);\n\t\t\tif (existUser) {\n\t\t\t\tthrow new APIError(\"BAD_REQUEST\", {\n\t\t\t\t\tmessage: ADMIN_ERROR_CODES.USER_ALREADY_EXISTS_USE_ANOTHER_EMAIL,\n\t\t\t\t});\n\t\t\t}\n\t\t\tconst user = await ctx.context.internalAdapter.createUser<UserWithRole>({\n\t\t\t\temail: email,\n\t\t\t\tname: ctx.body.name,\n\t\t\t\trole:\n\t\t\t\t\t(ctx.body.role && parseRoles(ctx.body.role)) ??\n\t\t\t\t\topts?.defaultRole ??\n\t\t\t\t\t\"user\",\n\t\t\t\t...ctx.body.data,\n\t\t\t});\n\n\t\t\tif (!user) {\n\t\t\t\tthrow new APIError(\"INTERNAL_SERVER_ERROR\", {\n\t\t\t\t\tmessage: ADMIN_ERROR_CODES.FAILED_TO_CREATE_USER,\n\t\t\t\t});\n\t\t\t}\n\t\t\tconst hashedPassword = await ctx.context.password.hash(ctx.body.password);\n\t\t\tawait ctx.context.internalAdapter.linkAccount({\n\t\t\t\taccountId: user.id,\n\t\t\t\tproviderId: \"credential\",\n\t\t\t\tpassword: hashedPassword,\n\t\t\t\tuserId: user.id,\n\t\t\t});\n\t\t\treturn ctx.json({\n\t\t\t\tuser: user as UserWithRole,\n\t\t\t});\n\t\t},\n\t);\n\nconst adminUpdateUserBodySchema = z.object({\n\tuserId: z.coerce.string().meta({\n\t\tdescription: \"The user id\",\n\t}),\n\tdata: z.record(z.any(), z.any()).meta({\n\t\tdescription: \"The user data to update\",\n\t}),\n});\n\n/**\n * ### Endpoint\n *\n * POST `/admin/update-user`\n *\n * ### API Methods\n *\n * **server:**\n * `auth.api.adminUpdateUser`\n *\n * **client:**\n * `authClient.admin.updateUser`\n *\n * @see [Read our docs to learn more.](https://better-auth.com/docs/plugins/admin#api-method-admin-update-user)\n */\nexport const adminUpdateUser = (opts: AdminOptions) =>\n\tcreateAuthEndpoint(\n\t\t\"/admin/update-user\",\n\t\t{\n\t\t\tmethod: \"POST\",\n\t\t\tbody: adminUpdateUserBodySchema,\n\t\t\tuse: [adminMiddleware],\n\t\t\tmetadata: {\n\t\t\t\topenapi: {\n\t\t\t\t\toperationId: \"updateUser\",\n\t\t\t\t\tsummary: \"Update a user\",\n\t\t\t\t\tdescription: \"Update a user's details\",\n\t\t\t\t\tresponses: {\n\t\t\t\t\t\t200: {\n\t\t\t\t\t\t\tdescription: \"User updated\",\n\t\t\t\t\t\t\tcontent: {\n\t\t\t\t\t\t\t\t\"application/json\": {\n\t\t\t\t\t\t\t\t\tschema: {\n\t\t\t\t\t\t\t\t\t\ttype: \"object\",\n\t\t\t\t\t\t\t\t\t\tproperties: {\n\t\t\t\t\t\t\t\t\t\t\tuser: {\n\t\t\t\t\t\t\t\t\t\t\t\t$ref: \"#/components/schemas/User\",\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\t\t},\n\t\tasync (ctx) => {\n\t\t\tconst canUpdateUser = hasPermission({\n\t\t\t\tuserId: ctx.context.session.user.id,\n\t\t\t\trole: ctx.context.session.user.role,\n\t\t\t\toptions: opts,\n\t\t\t\tpermissions: {\n\t\t\t\t\tuser: [\"update\"],\n\t\t\t\t},\n\t\t\t});\n\t\t\tif (!canUpdateUser) {\n\t\t\t\tthrow ctx.error(\"FORBIDDEN\", {\n\t\t\t\t\tmessage: ADMIN_ERROR_CODES.YOU_ARE_NOT_ALLOWED_TO_UPDATE_USERS,\n\t\t\t\t\tcode: \"YOU_ARE_NOT_ALLOWED_TO_UPDATE_USERS\",\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif (Object.keys(ctx.body.data).length === 0) {\n\t\t\t\tthrow new APIError(\"BAD_REQUEST\", {\n\t\t\t\t\tmessage: ADMIN_ERROR_CODES.NO_DATA_TO_UPDATE,\n\t\t\t\t});\n\t\t\t}\n\n\t\t\t// Role changes must be guarded by `user:set-role` and validated against the role allow-list.\n\t\t\tif (Object.prototype.hasOwnProperty.call(ctx.body.data, \"role\")) {\n\t\t\t\tconst canSetRole = hasPermission({\n\t\t\t\t\tuserId: ctx.context.session.user.id,\n\t\t\t\t\trole: ctx.context.session.user.role,\n\t\t\t\t\toptions: opts,\n\t\t\t\t\tpermissions: {\n\t\t\t\t\t\tuser: [\"set-role\"],\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t\tif (!canSetRole) {\n\t\t\t\t\tthrow new APIError(\"FORBIDDEN\", {\n\t\t\t\t\t\tmessage: ADMIN_ERROR_CODES.YOU_ARE_NOT_ALLOWED_TO_CHANGE_USERS_ROLE,\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tconst roleValue = (ctx.body.data as Record<string, any>).role;\n\t\t\t\tconst inputRoles = Array.isArray(roleValue) ? roleValue : [roleValue];\n\t\t\t\tfor (const role of inputRoles) {\n\t\t\t\t\tif (typeof role !== \"string\") {\n\t\t\t\t\t\tthrow new APIError(\"BAD_REQUEST\", {\n\t\t\t\t\t\t\tmessage: ADMIN_ERROR_CODES.INVALID_ROLE_TYPE,\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\tif (opts.roles && !opts.roles[role as keyof typeof opts.roles]) {\n\t\t\t\t\t\tthrow new APIError(\"BAD_REQUEST\", {\n\t\t\t\t\t\t\tmessage:\n\t\t\t\t\t\t\t\tADMIN_ERROR_CODES.YOU_ARE_NOT_ALLOWED_TO_SET_NON_EXISTENT_VALUE,\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t(ctx.body.data as Record<string, any>).role = parseRoles(\n\t\t\t\t\tinputRoles as string[],\n\t\t\t\t);\n\t\t\t}\n\t\t\tconst updatedUser = await ctx.context.internalAdapter.updateUser(\n\t\t\t\tctx.body.userId,\n\t\t\t\tctx.body.data,\n\t\t\t);\n\n\t\t\treturn ctx.json(updatedUser as UserWithRole);\n\t\t},\n\t);\n\nconst listUsersQuerySchema = z.object({\n\tsearchValue: z.string().optional().meta({\n\t\tdescription: 'The value to search for. Eg: \"some name\"',\n\t}),\n\tsearchField: z\n\t\t.enum([\"email\", \"name\"])\n\t\t.meta({\n\t\t\tdescription:\n\t\t\t\t'The field to search in, defaults to email. Can be `email` or `name`. Eg: \"name\"',\n\t\t})\n\t\t.optional(),\n\tsearchOperator: z\n\t\t.enum([\"contains\", \"starts_with\", \"ends_with\"])\n\t\t.meta({\n\t\t\tdescription:\n\t\t\t\t'The operator to use for the search. Can be `contains`, `starts_with` or `ends_with`. Eg: \"contains\"',\n\t\t})\n\t\t.optional(),\n\tlimit: z\n\t\t.string()\n\t\t.meta({\n\t\t\tdescription: \"The number of users to return\",\n\t\t})\n\t\t.or(z.number())\n\t\t.optional(),\n\toffset: z\n\t\t.string()\n\t\t.meta({\n\t\t\tdescription: \"The offset to start from\",\n\t\t})\n\t\t.or(z.number())\n\t\t.optional(),\n\tsortBy: z\n\t\t.string()\n\t\t.meta({\n\t\t\tdescription: \"The field to sort by\",\n\t\t})\n\t\t.optional(),\n\tsortDirection: z\n\t\t.enum([\"asc\", \"desc\"])\n\t\t.meta({\n\t\t\tdescription: \"The direction to sort by\",\n\t\t})\n\t\t.optional(),\n\tfilterField: z\n\t\t.string()\n\t\t.meta({\n\t\t\tdescription: \"The field to filter by\",\n\t\t})\n\t\t.optional(),\n\tfilterValue: z\n\t\t.string()\n\t\t.meta({\n\t\t\tdescription: \"The value to filter by\",\n\t\t})\n\t\t.or(z.number())\n\t\t.or(z.boolean())\n\t\t.optional(),\n\tfilterOperator: z\n\t\t.enum([\"eq\", \"ne\", \"lt\", \"lte\", \"gt\", \"gte\", \"contains\"])\n\t\t.meta({\n\t\t\tdescription: \"The operator to use for the filter\",\n\t\t})\n\t\t.optional(),\n});\n\nexport const listUsers = (opts: AdminOptions) =>\n\tcreateAuthEndpoint(\n\t\t\"/admin/list-users\",\n\t\t{\n\t\t\tmethod: \"GET\",\n\t\t\tuse: [adminMiddleware],\n\t\t\tquery: listUsersQuerySchema,\n\t\t\tmetadata: {\n\t\t\t\topenapi: {\n\t\t\t\t\toperationId: \"listUsers\",\n\t\t\t\t\tsummary: \"List users\",\n\t\t\t\t\tdescription: \"List users\",\n\t\t\t\t\tresponses: {\n\t\t\t\t\t\t200: {\n\t\t\t\t\t\t\tdescription: \"List of users\",\n\t\t\t\t\t\t\tcontent: {\n\t\t\t\t\t\t\t\t\"application/json\": {\n\t\t\t\t\t\t\t\t\tschema: {\n\t\t\t\t\t\t\t\t\t\ttype: \"object\",\n\t\t\t\t\t\t\t\t\t\tproperties: {\n\t\t\t\t\t\t\t\t\t\t\tusers: {\n\t\t\t\t\t\t\t\t\t\t\t\ttype: \"array\",\n\t\t\t\t\t\t\t\t\t\t\t\titems: {\n\t\t\t\t\t\t\t\t\t\t\t\t\t$ref: \"#/components/schemas/User\",\n\t\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\ttotal: {\n\t\t\t\t\t\t\t\t\t\t\t\ttype: \"number\",\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\tlimit: {\n\t\t\t\t\t\t\t\t\t\t\t\ttype: \"number\",\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\toffset: {\n\t\t\t\t\t\t\t\t\t\t\t\ttype: \"number\",\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\trequired: [\"users\", \"total\"],\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\t\t},\n\t\tasync (ctx) => {\n\t\t\tconst session = ctx.context.session;\n\t\t\tconst canListUsers = hasPermission({\n\t\t\t\tuserId: ctx.context.session.user.id,\n\t\t\t\trole: session.user.role,\n\t\t\t\toptions: opts,\n\t\t\t\tpermissions: {\n\t\t\t\t\tuser: [\"list\"],\n\t\t\t\t},\n\t\t\t});\n\t\t\tif (!canListUsers) {\n\t\t\t\tthrow new APIError(\"FORBIDDEN\", {\n\t\t\t\t\tmessage: ADMIN_ERROR_CODES.YOU_ARE_NOT_ALLOWED_TO_LIST_USERS,\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tconst where: Where[] = [];\n\n\t\t\tif (ctx.query?.searchValue) {\n\t\t\t\twhere.push({\n\t\t\t\t\tfield: ctx.query.searchField || \"email\",\n\t\t\t\t\toperator: ctx.query.searchOperator || \"contains\",\n\t\t\t\t\tvalue: ctx.query.searchValue,\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif (ctx.query?.filterValue) {\n\t\t\t\twhere.push({\n\t\t\t\t\tfield: ctx.query.filterField || \"email\",\n\t\t\t\t\toperator: ctx.query.filterOperator || \"eq\",\n\t\t\t\t\tvalue: ctx.query.filterValue,\n\t\t\t\t});\n\t\t\t}\n\n\t\t\ttry {\n\t\t\t\tconst users = await ctx.context.internalAdapter.listUsers(\n\t\t\t\t\tNumber(ctx.query?.limit) || undefined,\n\t\t\t\t\tNumber(ctx.query?.offset) || undefined,\n\t\t\t\t\tctx.query?.sortBy\n\t\t\t\t\t\t? {\n\t\t\t\t\t\t\t\tfield: ctx.query.sortBy,\n\t\t\t\t\t\t\t\tdirection: ctx.query.sortDirection || \"asc\",\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t: undefined,\n\t\t\t\t\twhere.length ? where : undefined,\n\t\t\t\t);\n\t\t\t\tconst total = await ctx.context.internalAdapter.countTotalUsers(\n\t\t\t\t\twhere.length ? where : undefined,\n\t\t\t\t);\n\t\t\t\treturn ctx.json({\n\t\t\t\t\tusers: users as UserWithRole[],\n\t\t\t\t\ttotal: total,\n\t\t\t\t\tlimit: Number(ctx.query?.limit) || undefined,\n\t\t\t\t\toffset: Number(ctx.query?.offset) || undefined,\n\t\t\t\t});\n\t\t\t} catch {\n\t\t\t\treturn ctx.json({\n\t\t\t\t\tusers: [],\n\t\t\t\t\ttotal: 0,\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t);\n\nconst listUserSessionsBodySchema = z.object({\n\tuserId: z.coerce.string().meta({\n\t\tdescription: \"The user id\",\n\t}),\n});\n\n/**\n * ### Endpoint\n *\n * POST `/admin/list-user-sessions`\n *\n * ### API Methods\n *\n * **server:**\n * `auth.api.listUserSessions`\n *\n * **client:**\n * `authClient.admin.listUserSessions`\n *\n * @see [Read our docs to learn more.](https://better-auth.com/docs/plugins/admin#api-method-admin-list-user-sessions)\n */\nexport const listUserSessions = (opts: AdminOptions) =>\n\tcreateAuthEndpoint(\n\t\t\"/admin/list-user-sessions\",\n\t\t{\n\t\t\tmethod: \"POST\",\n\t\t\tuse: [adminMiddleware],\n\t\t\tbody: listUserSessionsBodySchema,\n\t\t\tmetadata: {\n\t\t\t\topenapi: {\n\t\t\t\t\toperationId: \"listUserSessions\",\n\t\t\t\t\tsummary: \"List user sessions\",\n\t\t\t\t\tdescription: \"List user sessions\",\n\t\t\t\t\tresponses: {\n\t\t\t\t\t\t200: {\n\t\t\t\t\t\t\tdescription: \"List of user sessions\",\n\t\t\t\t\t\t\tcontent: {\n\t\t\t\t\t\t\t\t\"application/json\": {\n\t\t\t\t\t\t\t\t\tschema: {\n\t\t\t\t\t\t\t\t\t\ttype: \"object\",\n\t\t\t\t\t\t\t\t\t\tproperties: {\n\t\t\t\t\t\t\t\t\t\t\tsessions: {\n\t\t\t\t\t\t\t\t\t\t\t\ttype: \"array\",\n\t\t\t\t\t\t\t\t\t\t\t\titems: {\n\t\t\t\t\t\t\t\t\t\t\t\t\t$ref: \"#/components/schemas/Session\",\n\t\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\t\t},\n\t\tasync (ctx) => {\n\t\t\tconst session = ctx.context.session;\n\t\t\tconst canListSessions = hasPermission({\n\t\t\t\tuserId: ctx.context.session.user.id,\n\t\t\t\trole: session.user.role,\n\t\t\t\toptions: opts,\n\t\t\t\tpermissions: {\n\t\t\t\t\tsession: [\"list\"],\n\t\t\t\t},\n\t\t\t});\n\t\t\tif (!canListSessions) {\n\t\t\t\tthrow new APIError(\"FORBIDDEN\", {\n\t\t\t\t\tmessage: ADMIN_ERROR_CODES.YOU_ARE_NOT_ALLOWED_TO_LIST_USERS_SESSIONS,\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tconst sessions: SessionWithImpersonatedBy[] =\n\t\t\t\tawait ctx.context.internalAdapter.listSessions(ctx.body.userId);\n\t\t\treturn {\n\t\t\t\tsessions: sessions,\n\t\t\t};\n\t\t},\n\t);\n\nconst unbanUserBodySchema = z.object({\n\tuserId: z.coerce.string().meta({\n\t\tdescription: \"The user id\",\n\t}),\n});\n\n/**\n * ### Endpoint\n *\n * POST `/admin/unban-user`\n *\n * ### API Methods\n *\n * **server:**\n * `auth.api.unbanUser`\n *\n * **client:**\n * `authClient.admin.unbanUser`\n *\n * @see [Read our docs to learn more.](https://better-auth.com/docs/plugins/admin#api-method-admin-unban-user)\n */\nexport const unbanUser = (opts: AdminOptions) =>\n\tcreateAuthEndpoint(\n\t\t\"/admin/unban-user\",\n\t\t{\n\t\t\tmethod: \"POST\",\n\t\t\tbody: unbanUserBodySchema,\n\t\t\tuse: [adminMiddleware],\n\t\t\tmetadata: {\n\t\t\t\topenapi: {\n\t\t\t\t\toperationId: \"unbanUser\",\n\t\t\t\t\tsummary: \"Unban a user\",\n\t\t\t\t\tdescription: \"Unban a user\",\n\t\t\t\t\tresponses: {\n\t\t\t\t\t\t200: {\n\t\t\t\t\t\t\tdescription: \"User unbanned\",\n\t\t\t\t\t\t\tcontent: {\n\t\t\t\t\t\t\t\t\"application/json\": {\n\t\t\t\t\t\t\t\t\tschema: {\n\t\t\t\t\t\t\t\t\t\ttype: \"object\",\n\t\t\t\t\t\t\t\t\t\tproperties: {\n\t\t\t\t\t\t\t\t\t\t\tuser: {\n\t\t\t\t\t\t\t\t\t\t\t\t$ref: \"#/components/schemas/User\",\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\t\t},\n\t\tasync (ctx) => {\n\t\t\tconst session = ctx.context.session;\n\t\t\tconst canBanUser = hasPermission({\n\t\t\t\tuserId: ctx.context.session.user.id,\n\t\t\t\trole: session.user.role,\n\t\t\t\toptions: opts,\n\t\t\t\tpermissions: {\n\t\t\t\t\tuser: [\"ban\"],\n\t\t\t\t},\n\t\t\t});\n\t\t\tif (!canBanUser) {\n\t\t\t\tthrow new APIError(\"FORBIDDEN\", {\n\t\t\t\t\tmessage: ADMIN_ERROR_CODES.YOU_ARE_NOT_ALLOWED_TO_BAN_USERS,\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tconst user = await ctx.context.internalAdapter.updateUser(\n\t\t\t\tctx.body.userId,\n\t\t\t\t{\n\t\t\t\t\tbanned: false,\n\t\t\t\t\tbanExpires: null,\n\t\t\t\t\tbanReason: null,\n\t\t\t\t\tupdatedAt: new Date(),\n\t\t\t\t},\n\t\t\t);\n\t\t\treturn ctx.json({\n\t\t\t\tuser: user,\n\t\t\t});\n\t\t},\n\t);\n\nconst banUserBodySchema = z.object({\n\tuserId: z.coerce.string().meta({\n\t\tdescription: \"The user id\",\n\t}),\n\t/**\n\t * Reason for the ban\n\t */\n\tbanReason: z\n\t\t.string()\n\t\t.meta({\n\t\t\tdescription: \"The reason for the ban\",\n\t\t})\n\t\t.optional(),\n\t/**\n\t * Number of seconds until the ban expires\n\t */\n\tbanExpiresIn: z\n\t\t.number()\n\t\t.meta({\n\t\t\tdescription: \"The number of seconds until the ban expires\",\n\t\t})\n\t\t.optional(),\n});\n\n/**\n * ### Endpoint\n *\n * POST `/admin/ban-user`\n *\n * ### API Methods\n *\n * **server:**\n * `auth.api.banUser`\n *\n * **client:**\n * `authClient.admin.banUser`\n *\n * @see [Read our docs to learn more.](https://better-auth.com/docs/plugins/admin#api-method-admin-ban-user)\n */\nexport const banUser = (opts: AdminOptions) =>\n\tcreateAuthEndpoint(\n\t\t\"/admin/ban-user\",\n\t\t{\n\t\t\tmethod: \"POST\",\n\t\t\tbody: banUserBodySchema,\n\t\t\tuse: [adminMiddleware],\n\t\t\tmetadata: {\n\t\t\t\topenapi: {\n\t\t\t\t\toperationId: \"banUser\",\n\t\t\t\t\tsummary: \"Ban a user\",\n\t\t\t\t\tdescription: \"Ban a user\",\n\t\t\t\t\tresponses: {\n\t\t\t\t\t\t200: {\n\t\t\t\t\t\t\tdescription: \"User banned\",\n\t\t\t\t\t\t\tcontent: {\n\t\t\t\t\t\t\t\t\"application/json\": {\n\t\t\t\t\t\t\t\t\tschema: {\n\t\t\t\t\t\t\t\t\t\ttype: \"object\",\n\t\t\t\t\t\t\t\t\t\tproperties: {\n\t\t\t\t\t\t\t\t\t\t\tuser: {\n\t\t\t\t\t\t\t\t\t\t\t\t$ref: \"#/components/schemas/User\",\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\t\t},\n\t\tasync (ctx) => {\n\t\t\tconst session = ctx.context.session;\n\t\t\tconst canBanUser = hasPermission({\n\t\t\t\tuserId: ctx.context.session.user.id,\n\t\t\t\trole: session.user.role,\n\t\t\t\toptions: opts,\n\t\t\t\tpermissions: {\n\t\t\t\t\tuser: [\"ban\"],\n\t\t\t\t},\n\t\t\t});\n\t\t\tif (!canBanUser) {\n\t\t\t\tthrow new APIError(\"FORBIDDEN\", {\n\t\t\t\t\tmessage: ADMIN_ERROR_CODES.YOU_ARE_NOT_ALLOWED_TO_BAN_USERS,\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tconst foundUser = await ctx.context.internalAdapter.findUserById(\n\t\t\t\tctx.body.userId,\n\t\t\t);\n\n\t\t\tif (!foundUser) {\n\t\t\t\tthrow new APIError(\"NOT_FOUND\", {\n\t\t\t\t\tmessage: BASE_ERROR_CODES.USER_NOT_FOUND,\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif (ctx.body.userId === ctx.context.session.user.id) {\n\t\t\t\tthrow new APIError(\"BAD_REQUEST\", {\n\t\t\t\t\tmessage: ADMIN_ERROR_CODES.YOU_CANNOT_BAN_YOURSELF,\n\t\t\t\t});\n\t\t\t}\n\t\t\tconst user = await ctx.context.internalAdapter.updateUser(\n\t\t\t\tctx.body.userId,\n\t\t\t\t{\n\t\t\t\t\tbanned: true,\n\t\t\t\t\tbanReason:\n\t\t\t\t\t\tctx.body.banReason || opts?.defaultBanReason || \"No reason\",\n\t\t\t\t\tbanExpires: ctx.body.banExpiresIn\n\t\t\t\t\t\t? getDate(ctx.body.banExpiresIn, \"sec\")\n\t\t\t\t\t\t: opts?.defaultBanExpiresIn\n\t\t\t\t\t\t\t? getDate(opts.defaultBanExpiresIn, \"sec\")\n\t\t\t\t\t\t\t: undefined,\n\t\t\t\t\tupdatedAt: new Date(),\n\t\t\t\t},\n\t\t\t);\n\t\t\t//revoke all sessions\n\t\t\tawait ctx.context.internalAdapter.deleteSessions(ctx.body.userId);\n\t\t\treturn ctx.json({\n\t\t\t\tuser: user,\n\t\t\t});\n\t\t},\n\t);\n\nconst impersonateUserBodySchema = z.object({\n\tuserId: z.coerce.string().meta({\n\t\tdescription: \"The user id\",\n\t}),\n});\n/**\n * ### Endpoint\n *\n * POST `/admin/impersonate-user`\n *\n * ### API Methods\n *\n * **server:**\n * `auth.api.impersonateUser`\n *\n * **client:**\n * `authClient.admin.impersonateUser`\n *\n * @see [Read our docs to learn more.](https://better-auth.com/docs/plugins/admin#api-method-admin-impersonate-user)\n */\nexport const impersonateUser = (opts: AdminOptions) =>\n\tcreateAuthEndpoint(\n\t\t\"/admin/impersonate-user\",\n\t\t{\n\t\t\tmethod: \"POST\",\n\t\t\tbody: impersonateUserBodySchema,\n\t\t\tuse: [adminMiddleware],\n\t\t\tmetadata: {\n\t\t\t\topenapi: {\n\t\t\t\t\toperationId: \"impersonateUser\",\n\t\t\t\t\tsummary: \"Impersonate a user\",\n\t\t\t\t\tdescription: \"Impersonate a user\",\n\t\t\t\t\tresponses: {\n\t\t\t\t\t\t200: {\n\t\t\t\t\t\t\tdescription: \"Impersonation session created\",\n\t\t\t\t\t\t\tcontent: {\n\t\t\t\t\t\t\t\t\"application/json\": {\n\t\t\t\t\t\t\t\t\tschema: {\n\t\t\t\t\t\t\t\t\t\ttype: \"object\",\n\t\t\t\t\t\t\t\t\t\tproperties: {\n\t\t\t\t\t\t\t\t\t\t\tsession: {\n\t\t\t\t\t\t\t\t\t\t\t\t$ref: \"#/components/schemas/Session\",\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\tuser: {\n\t\t\t\t\t\t\t\t\t\t\t\t$ref: \"#/components/schemas/User\",\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\t\t},\n\t\tasync (ctx) => {\n\t\t\tconst canImpersonateUser = hasPermission({\n\t\t\t\tuserId: ctx.context.session.user.id,\n\t\t\t\trole: ctx.context.session.user.role,\n\t\t\t\toptions: opts,\n\t\t\t\tpermissions: {\n\t\t\t\t\tuser: [\"impersonate\"],\n\t\t\t\t},\n\t\t\t});\n\t\t\tif (!canImpersonateUser) {\n\t\t\t\tthrow new APIError(\"FORBIDDEN\", {\n\t\t\t\t\tmessage: ADMIN_ERROR_CODES.YOU_ARE_NOT_ALLOWED_TO_IMPERSONATE_USERS,\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tconst targetUser = (await ctx.context.internalAdapter.findUserById(\n\t\t\t\tctx.body.userId,\n\t\t\t)) as UserWithRole | null;\n\n\t\t\tif (!targetUser) {\n\t\t\t\tthrow new APIError(\"NOT_FOUND\", {\n\t\t\t\t\tmessage: \"User not found\",\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tconst adminRoles = (\n\t\t\t\tArray.isArray(opts.adminRoles)\n\t\t\t\t\t? opts.adminRoles\n\t\t\t\t\t: opts.adminRoles?.split(\",\") || []\n\t\t\t).map((role) => role.trim());\n\t\t\tconst targetUserRole = (\n\t\t\t\ttargetUser.role ||\n\t\t\t\topts.defaultRole ||\n\t\t\t\t\"user\"\n\t\t\t).split(\",\");\n\t\t\tif (\n\t\t\t\topts.allowImpersonatingAdmins !== true &&\n\t\t\t\t(targetUserRole.some((role) => adminRoles.includes(role)) ||\n\t\t\t\t\topts.adminUserIds?.includes(targetUser.id))\n\t\t\t) {\n\t\t\t\tthrow new APIError(\"FORBIDDEN\", {\n\t\t\t\t\tmessage: ADMIN_ERROR_CODES.YOU_CANNOT_IMPERSONATE_ADMINS,\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tconst session = await ctx.context.internalAdapter.createSession(\n\t\t\t\ttargetUser.id,\n\t\t\t\ttrue,\n\t\t\t\t{\n\t\t\t\t\timpersonatedBy: ctx.context.session.user.id,\n\t\t\t\t\texpiresAt: opts?.impersonationSessionDuration\n\t\t\t\t\t\t? getDate(opts.impersonationSessionDuration, \"sec\")\n\t\t\t\t\t\t: getDate(60 * 60, \"sec\"), // 1 hour\n\t\t\t\t},\n\t\t\t\ttrue,\n\t\t\t);\n\t\t\tif (!session) {\n\t\t\t\tthrow new APIError(\"INTERNAL_SERVER_ERROR\", {\n\t\t\t\t\tmessage: ADMIN_ERROR_CODES.FAILED_TO_CREATE_USER,\n\t\t\t\t});\n\t\t\t}\n\t\t\tconst authCookies = ctx.context.authCookies;\n\t\t\tdeleteSessionCookie(ctx);\n\t\t\tconst dontRememberMeCookie = await ctx.getSignedCookie(\n\t\t\t\tctx.context.authCookies.dontRememberToken.name,\n\t\t\t\tctx.context.secret,\n\t\t\t);\n\t\t\tconst adminCookieProp = ctx.context.createAuthCookie(\"admin_session\");\n\t\t\tawait ctx.setSignedCookie(\n\t\t\t\tadminCookieProp.name,\n\t\t\t\t`${ctx.context.session.session.token}:${dontRememberMeCookie || \"\"}`,\n\t\t\t\tctx.context.secret,\n\t\t\t\tauthCookies.sessionToken.options,\n\t\t\t);\n\t\t\tawait setSessionCookie(\n\t\t\t\tctx,\n\t\t\t\t{\n\t\t\t\t\tsession: session,\n\t\t\t\t\tuser: targetUser,\n\t\t\t\t},\n\t\t\t\ttrue,\n\t\t\t);\n\t\t\treturn ctx.json({\n\t\t\t\tsession: session,\n\t\t\t\tuser: targetUser,\n\t\t\t});\n\t\t},\n\t);\n\n/**\n * ### Endpoint\n *\n * POST `/admin/stop-impersonating`\n *\n * ### API Methods\n *\n * **server:**\n * `auth.api.stopImpersonating`\n *\n * **client:**\n * `authClient.admin.stopImpersonating`\n *\n * @see [Read our docs to learn more.](https://better-auth.com/docs/plugins/admin#api-method-admin-stop-impersonating)\n */\nexport const stopImpersonating = () =>\n\tcreateAuthEndpoint(\n\t\t\"/admin/stop-impersonating\",\n\t\t{\n\t\t\tmethod: \"POST\",\n\t\t\trequireHeaders: true,\n\t\t},\n\t\tasync (ctx) => {\n\t\t\tconst session = await getSessionFromCtx<\n\t\t\t\t{},\n\t\t\t\t{\n\t\t\t\t\timpersonatedBy: string;\n\t\t\t\t}\n\t\t\t>(ctx);\n\t\t\tif (!session) {\n\t\t\t\tthrow new APIError(\"UNAUTHORIZED\");\n\t\t\t}\n\t\t\tif (!session.session.impersonatedBy) {\n\t\t\t\tthrow new APIError(\"BAD_REQUEST\", {\n\t\t\t\t\tmessage: \"You are not impersonating anyone\",\n\t\t\t\t});\n\t\t\t}\n\t\t\tconst user = await ctx.context.internalAdapter.findUserById(\n\t\t\t\tsession.session.impersonatedBy,\n\t\t\t);\n\t\t\tif (!user) {\n\t\t\t\tthrow new APIError(\"INTERNAL_SERVER_ERROR\", {\n\t\t\t\t\tmessage: \"Failed to find user\",\n\t\t\t\t});\n\t\t\t}\n\t\t\tconst adminCookieName =\n\t\t\t\tctx.context.createAuthCookie(\"admin_session\").name;\n\t\t\tconst adminCookie = await ctx.getSignedCookie(\n\t\t\t\tadminCookieName,\n\t\t\t\tctx.context.secret,\n\t\t\t);\n\n\t\t\tif (!adminCookie) {\n\t\t\t\tthrow new APIError(\"INTERNAL_SERVER_ERROR\", {\n\t\t\t\t\tmessage: \"Failed to find admin session\",\n\t\t\t\t});\n\t\t\t}\n\t\t\tconst [adminSessionToken, dontRememberMeCookie] = adminCookie?.split(\":\");\n\t\t\tconst adminSession = await ctx.context.internalAdapter.findSession(\n\t\t\t\tadminSessionToken!,\n\t\t\t);\n\t\t\tif (!adminSession || adminSession.session.userId !== user.id) {\n\t\t\t\tthrow new APIError(\"INTERNAL_SERVER_ERROR\", {\n\t\t\t\t\tmessage: \"Failed to find admin session\",\n\t\t\t\t});\n\t\t\t}\n\t\t\tawait ctx.context.internalAdapter.deleteSession(session.session.token);\n\t\t\tawait setSessionCookie(ctx, adminSession, !!dontRememberMeCookie);\n\t\t\tawait ctx.setSignedCookie(adminCookieName, \"\", ctx.context.secret, {\n\t\t\t\t...ctx.context.authCookies.sessionToken.options,\n\t\t\t\tmaxAge: 0,\n\t\t\t});\n\t\t\treturn ctx.json(adminSession);\n\t\t},\n\t);\n\nconst revokeUserSessionBodySchema = z.object({\n\tsessionToken: z.string().meta({\n\t\tdescription: \"The session token\",\n\t}),\n});\n/**\n * ### Endpoint\n *\n * POST `/admin/revoke-user-session`\n *\n * ### API Methods\n *\n * **server:**\n * `auth.api.revokeUserSession`\n *\n * **client:**\n * `authClient.admin.revokeUserSession`\n *\n * @see [Read our docs to learn more.](https://better-auth.com/docs/plugins/admin#api-method-admin-revoke-user-session)\n */\nexport const revokeUserSession = (opts: AdminOptions) =>\n\tcreateAuthEndpoint(\n\t\t\"/admin/revoke-user-session\",\n\t\t{\n\t\t\tmethod: \"POST\",\n\t\t\tbody: revokeUserSessionBodySchema,\n\t\t\tuse: [adminMiddleware],\n\t\t\tmetadata: {\n\t\t\t\topenapi: {\n\t\t\t\t\toperationId: \"revokeUserSession\",\n\t\t\t\t\tsummary: \"Revoke a user session\",\n\t\t\t\t\tdescription: \"Revoke a user session\",\n\t\t\t\t\tresponses: {\n\t\t\t\t\t\t200: {\n\t\t\t\t\t\t\tdescription: \"Session revoked\",\n\t\t\t\t\t\t\tcontent: {\n\t\t\t\t\t\t\t\t\"application/json\": {\n\t\t\t\t\t\t\t\t\tschema: {\n\t\t\t\t\t\t\t\t\t\ttype: \"object\",\n\t\t\t\t\t\t\t\t\t\tproperties: {\n\t\t\t\t\t\t\t\t\t\t\tsuccess: {\n\t\t\t\t\t\t\t\t\t\t\t\ttype: \"boolean\",\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\t\t},\n\t\tasync (ctx) => {\n\t\t\tconst session = ctx.context.session;\n\t\t\tconst canRevokeSession = hasPermission({\n\t\t\t\tuserId: ctx.context.session.user.id,\n\t\t\t\trole: session.user.role,\n\t\t\t\toptions: opts,\n\t\t\t\tpermissions: {\n\t\t\t\t\tsession: [\"revoke\"],\n\t\t\t\t},\n\t\t\t});\n\t\t\tif (!canRevokeSession) {\n\t\t\t\tthrow new APIError(\"FORBIDDEN\", {\n\t\t\t\t\tmessage:\n\t\t\t\t\t\tADMIN_ERROR_CODES.YOU_ARE_NOT_ALLOWED_TO_REVOKE_USERS_SESSIONS,\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tawait ctx.context.internalAdapter.deleteSession(ctx.body.sessionToken);\n\t\t\treturn ctx.json({\n\t\t\t\tsuccess: true,\n\t\t\t});\n\t\t},\n\t);\n\nconst revokeUserSessionsBodySchema = z.object({\n\tuserId: z.coerce.string().meta({\n\t\tdescription: \"The user id\",\n\t}),\n});\n/**\n * ### Endpoint\n *\n * POST `/admin/revoke-user-sessions`\n *\n * ### API Methods\n *\n * **server:**\n * `auth.api.revokeUserSessions`\n *\n * **client:**\n * `authClient.admin.revokeUserSessions`\n *\n * @see [Read our docs to learn more.](https://better-auth.com/docs/plugins/admin#api-method-admin-revoke-user-sessions)\n */\nexport const revokeUserSessions = (opts: AdminOptions) =>\n\tcreateAuthEndpoint(\n\t\t\"/admin/revoke-user-sessions\",\n\t\t{\n\t\t\tmethod: \"POST\",\n\t\t\tbody: revokeUserSessionsBodySchema,\n\t\t\tuse: [adminMiddleware],\n\t\t\tmetadata: {\n\t\t\t\topenapi: {\n\t\t\t\t\toperationId: \"revokeUserSessions\",\n\t\t\t\t\tsummary: \"Revoke all user sessions\",\n\t\t\t\t\tdescription: \"Revoke all user sessions\",\n\t\t\t\t\tresponses: {\n\t\t\t\t\t\t200: {\n\t\t\t\t\t\t\tdescription: \"Sessions revoked\",\n\t\t\t\t\t\t\tcontent: {\n\t\t\t\t\t\t\t\t\"application/json\": {\n\t\t\t\t\t\t\t\t\tschema: {\n\t\t\t\t\t\t\t\t\t\ttype: \"object\",\n\t\t\t\t\t\t\t\t\t\tproperties: {\n\t\t\t\t\t\t\t\t\t\t\tsuccess: {\n\t\t\t\t\t\t\t\t\t\t\t\ttype: \"boolean\",\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\t\t},\n\t\tasync (ctx) => {\n\t\t\tconst session = ctx.context.session;\n\t\t\tconst canRevokeSession = hasPermission({\n\t\t\t\tuserId: ctx.context.session.user.id,\n\t\t\t\trole: session.user.role,\n\t\t\t\toptions: opts,\n\t\t\t\tpermissions: {\n\t\t\t\t\tsession: [\"revoke\"],\n\t\t\t\t},\n\t\t\t});\n\t\t\tif (!canRevokeSession) {\n\t\t\t\tthrow new APIError(\"FORBIDDEN\", {\n\t\t\t\t\tmessage:\n\t\t\t\t\t\tADMIN_ERROR_CODES.YOU_ARE_NOT_ALLOWED_TO_REVOKE_USERS_SESSIONS,\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tawait ctx.context.internalAdapter.deleteSessions(ctx.body.userId);\n\t\t\treturn ctx.json({\n\t\t\t\tsuccess: true,\n\t\t\t});\n\t\t},\n\t);\n\nconst removeUserBodySchema = z.object({\n\tuserId: z.coerce.string().meta({\n\t\tdescription: \"The user id\",\n\t}),\n});\n\n/**\n * ### Endpoint\n *\n * POST `/admin/remove-user`\n *\n * ### API Methods\n *\n * **server:**\n * `auth.api.removeUser`\n *\n * **client:**\n * `authClient.admin.removeUser`\n *\n * @see [Read our docs to learn more.](https://better-auth.com/docs/plugins/admin#api-method-admin-remove-user)\n */\nexport const removeUser = (opts: AdminOptions) =>\n\tcreateAuthEndpoint(\n\t\t\"/admin/remove-user\",\n\t\t{\n\t\t\tmethod: \"POST\",\n\t\t\tbody: removeUserBodySchema,\n\t\t\tuse: [adminMiddleware],\n\t\t\tmetadata: {\n\t\t\t\topenapi: {\n\t\t\t\t\toperationId: \"removeUser\",\n\t\t\t\t\tsummary: \"Remove a user\",\n\t\t\t\t\tdescription:\n\t\t\t\t\t\t\"Delete a user and all their sessions and accounts. Cannot be undone.\",\n\t\t\t\t\tresponses: {\n\t\t\t\t\t\t200: {\n\t\t\t\t\t\t\tdescription: \"User removed\",\n\t\t\t\t\t\t\tcontent: {\n\t\t\t\t\t\t\t\t\"application/json\": {\n\t\t\t\t\t\t\t\t\tschema: {\n\t\t\t\t\t\t\t\t\t\ttype: \"object\",\n\t\t\t\t\t\t\t\t\t\tproperties: {\n\t\t\t\t\t\t\t\t\t\t\tsuccess: {\n\t\t\t\t\t\t\t\t\t\t\t\ttype: \"boolean\",\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\t\t},\n\t\tasync (ctx) => {\n\t\t\tconst session = ctx.context.session;\n\t\t\tconst canDeleteUser = hasPermission({\n\t\t\t\tuserId: ctx.context.session.user.id,\n\t\t\t\trole: session.user.role,\n\t\t\t\toptions: opts,\n\t\t\t\tpermissions: {\n\t\t\t\t\tuser: [\"delete\"],\n\t\t\t\t},\n\t\t\t});\n\t\t\tif (!canDeleteUser) {\n\t\t\t\tthrow new APIError(\"FORBIDDEN\", {\n\t\t\t\t\tmessage: ADMIN_ERROR_CODES.YOU_ARE_NOT_ALLOWED_TO_DELETE_USERS,\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif (ctx.body.userId === ctx.context.session.user.id) {\n\t\t\t\tthrow new APIError(\"BAD_REQUEST\", {\n\t\t\t\t\tmessage: ADMIN_ERROR_CODES.YOU_CANNOT_REMOVE_YOURSELF,\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tconst user = await ctx.context.internalAdapter.findUserById(\n\t\t\t\tctx.body.userId,\n\t\t\t);\n\n\t\t\tif (!user) {\n\t\t\t\tthrow new APIError(\"NOT_FOUND\", {\n\t\t\t\t\tmessage: \"User not found\",\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tawait ctx.context.internalAdapter.deleteUser(ctx.body.userId);\n\t\t\treturn ctx.json({\n\t\t\t\tsuccess: true,\n\t\t\t});\n\t\t},\n\t);\n\nconst setUserPasswordBodySchema = z.object({\n\tnewPassword: z.string().nonempty(\"newPassword cannot be empty\").meta({\n\t\tdescription: \"The new password\",\n\t}),\n\tuserId: z.coerce.string().nonempty(\"userId cannot be empty\").meta({\n\t\tdescription: \"The user id\",\n\t}),\n});\n\n/**\n * ### Endpoint\n *\n * POST `/admin/set-user-password`\n *\n * ### API Methods\n *\n * **server:**\n * `auth.api.setUserPassword`\n *\n * **client:**\n * `authClient.admin.setUserPassword`\n *\n * @see [Read our docs to learn more.](https://better-auth.com/docs/plugins/admin#api-method-admin-set-user-password)\n */\nexport const setUserPassword = (opts: AdminOptions) =>\n\tcreateAuthEndpoint(\n\t\t\"/admin/set-user-password\",\n\t\t{\n\t\t\tmethod: \"POST\",\n\t\t\tbody: setUserPasswordBodySchema,\n\t\t\tuse: [adminMiddleware],\n\t\t\tmetadata: {\n\t\t\t\topenapi: {\n\t\t\t\t\toperationId: \"setUserPassword\",\n\t\t\t\t\tsummary: \"Set a user's password\",\n\t\t\t\t\tdescription: \"Set a user's password\",\n\t\t\t\t\tresponses: {\n\t\t\t\t\t\t200: {\n\t\t\t\t\t\t\tdescription: \"Password set\",\n\t\t\t\t\t\t\tcontent: {\n\t\t\t\t\t\t\t\t\"application/json\": {\n\t\t\t\t\t\t\t\t\tschema: {\n\t\t\t\t\t\t\t\t\t\ttype: \"object\",\n\t\t\t\t\t\t\t\t\t\tproperties: {\n\t\t\t\t\t\t\t\t\t\t\tstatus: {\n\t\t\t\t\t\t\t\t\t\t\t\ttype: \"boolean\",\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\t\t},\n\t\tasync (ctx) => {\n\t\t\tconst canSetUserPassword = hasPermission({\n\t\t\t\tuserId: ctx.context.session.user.id,\n\t\t\t\trole: ctx.context.session.user.role,\n\t\t\t\toptions: opts,\n\t\t\t\tpermissions: {\n\t\t\t\t\tuser: [\"set-password\"],\n\t\t\t\t},\n\t\t\t});\n\t\t\tif (!canSetUserPassword) {\n\t\t\t\tthrow new APIError(\"FORBIDDEN\", {\n\t\t\t\t\tmessage: ADMIN_ERROR_CODES.YOU_ARE_NOT_ALLOWED_TO_SET_USERS_PASSWORD,\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tconst { newPassword, userId } = ctx.body;\n\t\t\tconst minPasswordLength = ctx.context.password.config.minPasswordLength;\n\t\t\tif (newPassword.length < minPasswordLength) {\n\t\t\t\tctx.context.logger.error(\"Password is too short\");\n\t\t\t\tthrow new APIError(\"BAD_REQUEST\", {\n\t\t\t\t\tmessage: BASE_ERROR_CODES.PASSWORD_TOO_SHORT,\n\t\t\t\t});\n\t\t\t}\n\t\t\tconst maxPasswordLength = ctx.context.password.config.maxPasswordLength;\n\t\t\tif (newPassword.length > maxPasswordLength) {\n\t\t\t\tctx.context.logger.error(\"Password is too long\");\n\t\t\t\tthrow new APIError(\"BAD_REQUEST\", {\n\t\t\t\t\tmessage: BASE_ERROR_CODES.PASSWORD_TOO_LONG,\n\t\t\t\t});\n\t\t\t}\n\t\t\tconst hashedPassword = await ctx.context.password.hash(newPassword);\n\t\t\tawait ctx.context.internalAdapter.updatePassword(userId, hashedPassword);\n\t\t\treturn ctx.json({\n\t\t\t\tstatus: true,\n\t\t\t});\n\t\t},\n\t);\n\nconst userHasPermissionBodySchema = z\n\t.object({\n\t\tuserId: z.coerce.string().optional().meta({\n\t\t\tdescription: `The user id. Eg: \"user-id\"`,\n\t\t}),\n\t\trole: z.string().optional().meta({\n\t\t\tdescription: `The role to check permission for. Eg: \"admin\"`,\n\t\t}),\n\t})\n\t.and(\n\t\tz.union([\n\t\t\tz.object({\n\t\t\t\tpermission: z.record(z.string(), z.array(z.string())),\n\t\t\t\tpermissions: z.undefined(),\n\t\t\t}),\n\t\t\tz.object({\n\t\t\t\tpermission: z.undefined(),\n\t\t\t\tpermissions: z.record(z.string(), z.array(z.string())),\n\t\t\t}),\n\t\t]),\n\t);\n\n/**\n * ### Endpoint\n *\n * POST `/admin/has-permission`\n *\n * ### API Methods\n *\n * **server:**\n * `auth.api.userHasPermission`\n *\n * **client:**\n * `authClient.admin.hasPermission`\n *\n * @see [Read our docs to learn more.](https://better-auth.com/docs/plugins/admin#api-method-admin-has-permission)\n */\nexport const userHasPermission = <O extends AdminOptions>(opts: O) => {\n\ttype DefaultStatements = typeof defaultStatements;\n\ttype Statements =\n\t\tO[\"ac\"] extends AccessControl<infer S> ? S : DefaultStatements;\n\n\ttype PermissionType = {\n\t\t[key in keyof Statements]?: Array<\n\t\t\tStatements[key] extends readonly unknown[]\n\t\t\t\t? Statements[key][number]\n\t\t\t\t: never\n\t\t>;\n\t};\n\ttype PermissionExclusive =\n\t\t| {\n\t\t\t\t/**\n\t\t\t\t * @deprecated Use `permissions` instead\n\t\t\t\t */\n\t\t\t\tpermission: PermissionType;\n\t\t\t\tpermissions?: never | undefined;\n\t\t  }\n\t\t| {\n\t\t\t\tpermissions: PermissionType;\n\t\t\t\tpermission?: never | undefined;\n\t\t  };\n\n\treturn createAuthEndpoint(\n\t\t\"/admin/has-permission\",\n\t\t{\n\t\t\tmethod: \"POST\",\n\t\t\tbody: userHasPermissionBodySchema,\n\t\t\tmetadata: {\n\t\t\t\topenapi: {\n\t\t\t\t\tdescription: \"Check if the user has permission\",\n\t\t\t\t\trequestBody: {\n\t\t\t\t\t\tcontent: {\n\t\t\t\t\t\t\t\"application/json\": {\n\t\t\t\t\t\t\t\tschema: {\n\t\t\t\t\t\t\t\t\ttype: \"object\",\n\t\t\t\t\t\t\t\t\tproperties: {\n\t\t\t\t\t\t\t\t\t\tpermission: {\n\t\t\t\t\t\t\t\t\t\t\ttype: \"object\",\n\t\t\t\t\t\t\t\t\t\t\tdescription: \"The permission to check\",\n\t\t\t\t\t\t\t\t\t\t\tdeprecated: true,\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\tpermissions: {\n\t\t\t\t\t\t\t\t\t\t\ttype: \"object\",\n\t\t\t\t\t\t\t\t\t\t\tdescription: \"The permission to check\",\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\trequired: [\"permissions\"],\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t\tresponses: {\n\t\t\t\t\t\t\"200\": {\n\t\t\t\t\t\t\tdescription: \"Success\",\n\t\t\t\t\t\t\tcontent: {\n\t\t\t\t\t\t\t\t\"application/json\": {\n\t\t\t\t\t\t\t\t\tschema: {\n\t\t\t\t\t\t\t\t\t\ttype: \"object\",\n\t\t\t\t\t\t\t\t\t\tproperties: {\n\t\t\t\t\t\t\t\t\t\t\terror: {\n\t\t\t\t\t\t\t\t\t\t\t\ttype: \"string\",\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\tsuccess: {\n\t\t\t\t\t\t\t\t\t\t\t\ttype: \"boolean\",\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\trequired: [\"success\"],\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t$Infer: {\n\t\t\t\t\tbody: {} as PermissionExclusive & {\n\t\t\t\t\t\tuserId?: string | undefined;\n\t\t\t\t\t\trole?: InferAdminRolesFromOption<O> | undefined;\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\t\t},\n\t\tasync (ctx) => {\n\t\t\tif (!ctx.body?.permission && !ctx.body?.permissions) {\n\t\t\t\tthrow new APIError(\"BAD_REQUEST\", {\n\t\t\t\t\tmessage: \"invalid permission check. no permission(s) were passed.\",\n\t\t\t\t});\n\t\t\t}\n\t\t\tconst session = await getSessionFromCtx(ctx);\n\n\t\t\tif (!session && (ctx.request || ctx.headers)) {\n\t\t\t\tthrow new APIError(\"UNAUTHORIZED\");\n\t\t\t}\n\t\t\tif (!session && !ctx.body.userId && !ctx.body.role) {\n\t\t\t\tthrow new APIError(\"BAD_REQUEST\", {\n\t\t\t\t\tmessage: \"user id or role is required\",\n\t\t\t\t});\n\t\t\t}\n\t\t\tconst user =\n\t\t\t\tsession?.user ||\n\t\t\t\t(ctx.body.role\n\t\t\t\t\t? { id: ctx.body.userId || \"\", role: ctx.body.role }\n\t\t\t\t\t: null) ||\n\t\t\t\t((await ctx.context.internalAdapter.findUserById(\n\t\t\t\t\tctx.body.userId as string,\n\t\t\t\t)) as { role?: string | undefined; id: string });\n\t\t\tif (!user) {\n\t\t\t\tthrow new APIError(\"BAD_REQUEST\", {\n\t\t\t\t\tmessage: \"user not found\",\n\t\t\t\t});\n\t\t\t}\n\t\t\tconst result = hasPermission({\n\t\t\t\tuserId: user.id,\n\t\t\t\trole: user.role,\n\t\t\t\toptions: opts as AdminOptions,\n\t\t\t\tpermissions: (ctx.body.permissions ?? ctx.body.permission) as any,\n\t\t\t});\n\t\t\treturn ctx.json({\n\t\t\t\terror: null,\n\t\t\t\tsuccess: result,\n\t\t\t});\n\t\t},\n\t);\n};\n"],"names":["where: Where[]"],"mappings":"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"}},
    {"offset": {"line": 1496, "column": 0}, "map": {"version":3,"file":"turbopack:///[project]/node_modules/.pnpm/better-auth@1.4.9_drizzle-kit@0.31.8_drizzle-orm@0.45.1_@opentelemetry+api@1.9.0_@types_2c2f84378f2ef24b1a7bf909953e43a4/node_modules/better-auth/dist/plugins/admin/schema.mjs","sources":["file:///Users/aunogarafat/Work/conversation/app/web/node_modules/.pnpm/better-auth%401.4.9_drizzle-kit%400.31.8_drizzle-orm%400.45.1_%40opentelemetry%2Bapi%401.9.0_%40types_2c2f84378f2ef24b1a7bf909953e43a4/node_modules/better-auth/src/plugins/admin/schema.ts"],"sourcesContent":["import type { BetterAuthPluginDBSchema } from \"@better-auth/core/db\";\n\nexport const schema = {\n\tuser: {\n\t\tfields: {\n\t\t\trole: {\n\t\t\t\ttype: \"string\",\n\t\t\t\trequired: false,\n\t\t\t\tinput: false,\n\t\t\t},\n\t\t\tbanned: {\n\t\t\t\ttype: \"boolean\",\n\t\t\t\tdefaultValue: false,\n\t\t\t\trequired: false,\n\t\t\t\tinput: false,\n\t\t\t},\n\t\t\tbanReason: {\n\t\t\t\ttype: \"string\",\n\t\t\t\trequired: false,\n\t\t\t\tinput: false,\n\t\t\t},\n\t\t\tbanExpires: {\n\t\t\t\ttype: \"date\",\n\t\t\t\trequired: false,\n\t\t\t\tinput: false,\n\t\t\t},\n\t\t},\n\t},\n\tsession: {\n\t\tfields: {\n\t\t\timpersonatedBy: {\n\t\t\t\ttype: \"string\",\n\t\t\t\trequired: false,\n\t\t\t},\n\t\t},\n\t},\n} satisfies BetterAuthPluginDBSchema;\n\nexport type AdminSchema = typeof schema;\n"],"names":[],"mappings":";;;;;AAEA,MAAa,SAAS;IACrB,MAAM;QACL,QAAQ;YACP,MAAM;gBACL,MAAM;gBACN,UAAU;gBACV,OAAO;aACP;YACD,QAAQ;gBACP,MAAM;gBACN,cAAc;gBACd,UAAU;gBACV,OAAO;aACP;YACD,WAAW;gBACV,MAAM;gBACN,UAAU;gBACV,OAAO;aACP;YACD,YAAY;gBACX,MAAM;gBACN,UAAU;gBACV,OAAO;aACP;SACD;IAAA,CACD;IACD,SAAS;QACR,QAAQ;YACP,gBAAgB;gBACf,MAAM;gBACN,UAAU;aACV;QAAA,CACD;IAAA,CACD;CACD"}},
    {"offset": {"line": 1542, "column": 0}, "map": {"version":3,"file":"turbopack:///[project]/node_modules/.pnpm/better-auth@1.4.9_drizzle-kit@0.31.8_drizzle-orm@0.45.1_@opentelemetry+api@1.9.0_@types_2c2f84378f2ef24b1a7bf909953e43a4/node_modules/better-auth/dist/plugins/admin/admin.mjs","sources":["file:///Users/aunogarafat/Work/conversation/app/web/node_modules/.pnpm/better-auth%401.4.9_drizzle-kit%400.31.8_drizzle-orm%400.45.1_%40opentelemetry%2Bapi%401.9.0_%40types_2c2f84378f2ef24b1a7bf909953e43a4/node_modules/better-auth/src/plugins/admin/admin.ts"],"sourcesContent":["import type { BetterAuthPlugin } from \"@better-auth/core\";\nimport { createAuthMiddleware } from \"@better-auth/core/api\";\nimport { BetterAuthError } from \"@better-auth/core/error\";\nimport { APIError } from \"../../api\";\nimport { mergeSchema } from \"../../db/schema\";\nimport { getEndpointResponse } from \"../../utils/plugin-helper\";\nimport { defaultRoles } from \"./access\";\nimport { ADMIN_ERROR_CODES } from \"./error-codes\";\nimport {\n\tadminUpdateUser,\n\tbanUser,\n\tcreateUser,\n\tgetUser,\n\timpersonateUser,\n\tlistUserSessions,\n\tlistUsers,\n\tremoveUser,\n\trevokeUserSession,\n\trevokeUserSessions,\n\tsetRole,\n\tsetUserPassword,\n\tstopImpersonating,\n\tunbanUser,\n\tuserHasPermission,\n} from \"./routes\";\nimport { schema } from \"./schema\";\nimport type {\n\tAdminOptions,\n\tSessionWithImpersonatedBy,\n\tUserWithRole,\n} from \"./types\";\n\nexport const admin = <O extends AdminOptions>(options?: O | undefined) => {\n\tconst opts = {\n\t\tdefaultRole: options?.defaultRole ?? \"user\",\n\t\tadminRoles: options?.adminRoles ?? [\"admin\"],\n\t\tbannedUserMessage:\n\t\t\toptions?.bannedUserMessage ??\n\t\t\t\"You have been banned from this application. Please contact support if you believe this is an error.\",\n\t\t...options,\n\t};\n\n\tif (options?.adminRoles) {\n\t\tconst adminRoles = Array.isArray(options.adminRoles)\n\t\t\t? options.adminRoles\n\t\t\t: [...options.adminRoles.split(\",\")];\n\t\tconst invalidRoles = adminRoles.filter(\n\t\t\t(role) =>\n\t\t\t\t!Object.keys(options?.roles || defaultRoles)\n\t\t\t\t\t.map((r) => r.toLowerCase())\n\t\t\t\t\t.includes(role.toLowerCase()),\n\t\t);\n\t\tif (invalidRoles.length > 0) {\n\t\t\tthrow new BetterAuthError(\n\t\t\t\t`Invalid admin roles: ${invalidRoles.join(\", \")}. Admin roles must be defined in the 'roles' configuration.`,\n\t\t\t);\n\t\t}\n\t}\n\n\treturn {\n\t\tid: \"admin\",\n\t\tinit() {\n\t\t\treturn {\n\t\t\t\toptions: {\n\t\t\t\t\tdatabaseHooks: {\n\t\t\t\t\t\tuser: {\n\t\t\t\t\t\t\tcreate: {\n\t\t\t\t\t\t\t\tasync before(user) {\n\t\t\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\t\t\t\t\trole: options?.defaultRole ?? \"user\",\n\t\t\t\t\t\t\t\t\t\t\t...user,\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t\tsession: {\n\t\t\t\t\t\t\tcreate: {\n\t\t\t\t\t\t\t\tasync before(session, ctx) {\n\t\t\t\t\t\t\t\t\tif (!ctx) {\n\t\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tconst user = (await ctx.context.internalAdapter.findUserById(\n\t\t\t\t\t\t\t\t\t\tsession.userId,\n\t\t\t\t\t\t\t\t\t)) as UserWithRole;\n\n\t\t\t\t\t\t\t\t\tif (user.banned) {\n\t\t\t\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\t\t\t\tuser.banExpires &&\n\t\t\t\t\t\t\t\t\t\t\tnew Date(user.banExpires).getTime() < Date.now()\n\t\t\t\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\t\t\t\tawait ctx.context.internalAdapter.updateUser(\n\t\t\t\t\t\t\t\t\t\t\t\tsession.userId,\n\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\tbanned: false,\n\t\t\t\t\t\t\t\t\t\t\t\t\tbanReason: null,\n\t\t\t\t\t\t\t\t\t\t\t\t\tbanExpires: null,\n\t\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\t\t\t\tctx &&\n\t\t\t\t\t\t\t\t\t\t\t(ctx.path.startsWith(\"/callback\") ||\n\t\t\t\t\t\t\t\t\t\t\t\tctx.path.startsWith(\"/oauth2/callback\"))\n\t\t\t\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\t\t\t\tconst redirectURI =\n\t\t\t\t\t\t\t\t\t\t\t\tctx.context.options.onAPIError?.errorURL ||\n\t\t\t\t\t\t\t\t\t\t\t\t`${ctx.context.baseURL}/error`;\n\t\t\t\t\t\t\t\t\t\t\tthrow ctx.redirect(\n\t\t\t\t\t\t\t\t\t\t\t\t`${redirectURI}?error=banned&error_description=${opts.bannedUserMessage}`,\n\t\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\tthrow new APIError(\"FORBIDDEN\", {\n\t\t\t\t\t\t\t\t\t\t\tmessage: opts.bannedUserMessage,\n\t\t\t\t\t\t\t\t\t\t\tcode: \"BANNED_USER\",\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t};\n\t\t},\n\t\thooks: {\n\t\t\tafter: [\n\t\t\t\t{\n\t\t\t\t\tmatcher(context) {\n\t\t\t\t\t\treturn context.path === \"/list-sessions\";\n\t\t\t\t\t},\n\t\t\t\t\thandler: createAuthMiddleware(async (ctx) => {\n\t\t\t\t\t\tconst response =\n\t\t\t\t\t\t\tawait getEndpointResponse<SessionWithImpersonatedBy[]>(ctx);\n\n\t\t\t\t\t\tif (!response) {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tconst newJson = response.filter((session) => {\n\t\t\t\t\t\t\treturn !session.impersonatedBy;\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\treturn ctx.json(newJson);\n\t\t\t\t\t}),\n\t\t\t\t},\n\t\t\t],\n\t\t},\n\t\tendpoints: {\n\t\t\tsetRole: setRole(opts),\n\t\t\tgetUser: getUser(opts),\n\t\t\tcreateUser: createUser(opts),\n\t\t\tadminUpdateUser: adminUpdateUser(opts),\n\t\t\tlistUsers: listUsers(opts),\n\t\t\tlistUserSessions: listUserSessions(opts),\n\t\t\tunbanUser: unbanUser(opts),\n\t\t\tbanUser: banUser(opts),\n\t\t\timpersonateUser: impersonateUser(opts),\n\t\t\tstopImpersonating: stopImpersonating(),\n\t\t\trevokeUserSession: revokeUserSession(opts),\n\t\t\trevokeUserSessions: revokeUserSessions(opts),\n\t\t\tremoveUser: removeUser(opts),\n\t\t\tsetUserPassword: setUserPassword(opts),\n\t\t\tuserHasPermission: userHasPermission(opts as O),\n\t\t},\n\t\t$ERROR_CODES: ADMIN_ERROR_CODES,\n\t\tschema: mergeSchema(schema, opts.schema),\n\t\toptions: options as NoInfer<O>,\n\t} satisfies BetterAuthPlugin;\n};\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1677, "column": 0}, "map": {"version":3,"sources":["file:///Users/aunogarafat/Work/conversation/app/web/node_modules/.pnpm/better-auth%401.4.9_drizzle-kit%400.31.8_drizzle-orm%400.45.1_%40opentelemetry%2Bapi%401.9.0_%40types_2c2f84378f2ef24b1a7bf909953e43a4/node_modules/better-auth/dist/plugins/admin/index.mjs"],"sourcesContent":["import { admin } from \"./admin.mjs\";\n\nexport { admin };"],"names":[],"mappings":";AAAA","ignoreList":[0]}}]
}